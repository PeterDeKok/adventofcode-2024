package main

import (
	"bufio"
	"context"
	"fmt"
	"io"
	"peterdekok.nl/adventofcode/twentytwentyfour/src/build"
	"peterdekok.nl/adventofcode/twentytwentyfour/src/tools/logger"
	"strconv"
	"strings"
)

const blinks = 75

func Solution(_ context.Context, _ *logger.IterationLogger, rd io.Reader, w io.Writer) error {
	var sum int
	defer func() {
		if _, err := w.Write([]byte(strconv.Itoa(sum))); err != nil {
			panic(err)
		}
	}()

	stones, err := parseInput(rd)
	if err != nil {
		return err
	}

	if build.DEBUG {
		for _, rr := range stones {
			fmt.Printf("%s ", string(rr))
		}
		fmt.Printf("\n\n")
	}

	// Note;
	// The last change to any stone is potentially skipped if it doesn't result
	// in a new stone.
	queue := make([]*TimeLoop, len(stones), 10*len(stones))

	for i, s := range stones {
		queue[i] = &TimeLoop{
			stone: s,
			i:     blinks,
		}
	}

	for i := 0; i < len(queue); i++ {
		if add, err := walker(queue[i], &queue); err != nil {
			return err
		} else {
			sum += add
			if build.DEBUG {
				fmt.Println(add)
			}
		}
	}

	sum += len(queue)

	return nil
}

func walker(tl *TimeLoop, queue *[]*TimeLoop) (add int, err error) {
	for ; tl.i > 0; tl.i-- {
		if n, ok := checkCache(tl.i, tl.stone); ok {
			tl.stone = []rune{'-'}
			tl.i = 0

			return n, nil
		}

		before := string(tl.stone)

		if len(tl.stone)%2 == 0 {
			ns := tl.stone[len(tl.stone)/2:]
			tl.stone = tl.stone[:len(tl.stone)/2]

			trim := 0
			for ; trim < len(ns)-1; trim++ {
				if ns[trim] != '0' {
					break
				}
			}
			ns = ns[trim:]

			if len(ns) == 0 {
				panic("Mistakes were made")
			}

			*queue = append(*queue, &TimeLoop{
				stone: ns,
				i:     tl.i - 1,
			})

			if build.DEBUG {
				fmt.Printf("stone split %*s -> %s %s\n", 25-tl.i-1, before, string(tl.stone), string(ns))
			}

			continue
		}

		if tl.i == 1 {
			if build.DEBUG {
				fmt.Printf("skip last i %*s\n", 25-tl.i-1, string(tl.stone))
			}
			// Skip the last step. It won't result in more stones.
			// We do skip the last changes to the slice, it won't resemble the true state!!!
			return 0, nil
		}

		if len(tl.stone) == 1 && tl.stone[0] == '0' {
			// Skip a few steps
			if tl.i <= 2 {
				continue
			}
			tl.i -= 2
			before = "2024"

			tl.stone = []rune{'2', '0'}

			*queue = append(*queue, &TimeLoop{
				stone: []rune{'2', '4'},
				i:     tl.i - 1,
			})

			if build.DEBUG {
				fmt.Printf("stone_split %*s -> %s %s\n", 25-tl.i-1, before, string(tl.stone), "24")
			}

			continue
		}

		nr := 0
		for _, r := range tl.stone {
			nr = nr*10 + int(r-'0')
		}
		nr *= 2024
		tl.stone = []rune(strconv.Itoa(nr))

		if build.DEBUG {
			fmt.Printf("stone*2024  %*s * 2024 -> %s\n", 25-tl.i-1, before, string(tl.stone))
		}
	}

	return 0, nil
}

func checkCache(i int, stone []rune) (int, bool) {
	if len(stone) == 1 {
		// Nope, not cheating, it's part of the problem description!
		switch stone[0] {
		case '0':
			if i >= len(lookup0Stone) {
				return 0, false
			}

			return lookup0Stone[i], true
		case '1':
			if i >= len(lookup1Stone) {
				return 0, false
			}

			return lookup1Stone[i], true
		case '2':
			if i >= len(lookup2Stone) {
				return 0, false
			}

			return lookup2Stone[i], true
		case '3':
			if i >= len(lookup3Stone) {
				return 0, false
			}

			return lookup3Stone[i], true
		case '4':
			if i >= len(lookup4Stone) {
				return 0, false
			}

			return lookup4Stone[i], true
		case '5':
			if i >= len(lookup5Stone) {
				return 0, false
			}

			return lookup5Stone[i], true
		case '6':
			if i >= len(lookup6Stone) {
				return 0, false
			}

			return lookup6Stone[i], true
		case '7':
			if i >= len(lookup7Stone) {
				return 0, false
			}

			return lookup7Stone[i], true
		case '8':
			if i >= len(lookup8Stone) {
				return 0, false
			}

			return lookup8Stone[i], true
		case '9':
			if i >= len(lookup9Stone) {
				return 0, false
			}

			return lookup9Stone[i], true
		default:
			return 0, false
		}
	}

	return 0, false
}

func parseInput(rd io.Reader) ([][]rune, error) {
	stones := make([][]rune, 0, 1000)

	brd := bufio.NewReader(rd)
	line, isPrefix, err := brd.ReadLine()

	if err != nil {
		return stones, err
	} else if isPrefix {
		return stones, fmt.Errorf("not entire line read")
	}

	for _, w := range strings.Fields(string(line)) {
		stones = append(stones, []rune(w))
	}

	return stones, nil
}

type TimeLoop struct {
	stone []rune
	i     int
}

var lookup0Stone = []int{
	0:  1 - 1,
	1:  1 - 1,
	2:  1 - 1,
	3:  2 - 1,
	4:  4 - 1,
	5:  4 - 1,
	6:  7 - 1,
	7:  14 - 1,
	8:  16 - 1,
	9:  20 - 1,
	10: 39 - 1,
	11: 62 - 1,
	12: 81 - 1,
	13: 110 - 1,
	14: 200 - 1,
	15: 328 - 1,
	16: 418 - 1,
	17: 667 - 1,
	18: 1059 - 1,
	19: 1546 - 1,
	20: 2377 - 1,
	21: 3572 - 1,
	22: 5602 - 1,
	23: 8268 - 1,
	24: 12343 - 1,
	25: 19778 - 1,
	26: 29165 - 1,
	27: 43726 - 1,
	28: 67724 - 1,
	29: 102131 - 1,
	30: 156451 - 1,
	31: 234511 - 1,
	32: 357632 - 1,
	33: 549949 - 1,
	34: 819967 - 1,
	35: 1258125 - 1,
	36: 1916299 - 1,
	37: 2886408 - 1,
	38: 4414216 - 1,
	39: 6669768 - 1,
	40: 10174278 - 1,
	41: 15458147 - 1,
	42: 23333796 - 1,
	43: 35712308 - 1,
	44: 54046805 - 1,
	45: 81997335 - 1,
	46: 125001266 - 1,
	47: 189148778 - 1,
	48: 288114305 - 1,
	49: 437102505 - 1,
	50: 663251546 - 1,
	51: 1010392024 - 1,
	52: 1529921658 - 1,
	53: 2327142660 - 1,
	54: 3537156082 - 1,
	55: 5362947711 - 1,
	56: 8161193535 - 1,
	57: 12380334344 - 1,
	58: 18810542532 - 1,
	59: 28593873985 - 1,
	60: 43369895096 - 1,
	61: 65961219181 - 1,
	62: 100139236592 - 1,
	63: 152044639077 - 1,
	64: 231153279853 - 1,
	65: 350788203951 - 1,
	66: 533109439771 - 1,
	67: 809736749749 - 1,
	68: 1229368413225 - 1,
	69: 1868593299929 - 1,
	70: 2836699741490 - 1,
	71: 4309440263048 - 1,
	72: 6547241478879 - 1,
	73: 9940362821695 - 1,
	74: 15104984244538 - 1,
	75: 22938365706844 - 1,
}

var lookup1Stone = []int{
	0:  1 - 1,
	1:  1 - 1,
	2:  2 - 1,
	3:  4 - 1,
	4:  4 - 1,
	5:  7 - 1,
	6:  14 - 1,
	7:  16 - 1,
	8:  20 - 1,
	9:  39 - 1,
	10: 62 - 1,
	11: 81 - 1,
	12: 110 - 1,
	13: 200 - 1,
	14: 328 - 1,
	15: 418 - 1,
	16: 667 - 1,
	17: 1059 - 1,
	18: 1546 - 1,
	19: 2377 - 1,
	20: 3572 - 1,
	21: 5602 - 1,
	22: 8268 - 1,
	23: 12343 - 1,
	24: 19778 - 1,
	25: 29165 - 1,
	26: 43726 - 1,
	27: 67724 - 1,
	28: 102131 - 1,
	29: 156451 - 1,
	30: 234511 - 1,
	31: 357632 - 1,
	32: 549949 - 1,
	33: 819967 - 1,
	34: 1258125 - 1,
	35: 1916299 - 1,
	36: 2886408 - 1,
	37: 4414216 - 1,
	38: 6669768 - 1,
	39: 10174278 - 1,
	40: 15458147 - 1,
	41: 23333796 - 1,
	42: 35712308 - 1,
	43: 54046805 - 1,
	44: 81997335 - 1,
	45: 125001266 - 1,
	46: 189148778 - 1,
	47: 288114305 - 1,
	48: 437102505 - 1,
	49: 663251546 - 1,
	50: 1010392024 - 1,
	51: 1529921658 - 1,
	52: 2327142660 - 1,
	53: 3537156082 - 1,
	54: 5362947711 - 1,
	55: 8161193535 - 1,
	56: 12380334344 - 1,
	57: 18810542532 - 1,
	58: 28593873985 - 1,
	59: 43369895096 - 1,
	60: 65961219181 - 1,
	61: 100139236592 - 1,
	62: 152044639077 - 1,
	63: 231153279853 - 1,
	64: 350788203951 - 1,
	65: 533109439771 - 1,
	66: 809736749749 - 1,
	67: 1229368413225 - 1,
	68: 1868593299929 - 1,
	69: 2836699741490 - 1,
	70: 4309440263048 - 1,
	71: 6547241478879 - 1,
	72: 9940362821695 - 1,
	73: 15104984244538 - 1,
	74: 22938365706844 - 1,
	75: 34840149002654 - 1,
}

var lookup2Stone = []int{
	0:  1 - 1,
	1:  1 - 1,
	2:  2 - 1,
	3:  4 - 1,
	4:  4 - 1,
	5:  6 - 1,
	6:  12 - 1,
	7:  16 - 1,
	8:  19 - 1,
	9:  30 - 1,
	10: 57 - 1,
	11: 92 - 1,
	12: 111 - 1,
	13: 181 - 1,
	14: 295 - 1,
	15: 414 - 1,
	16: 661 - 1,
	17: 977 - 1,
	18: 1501 - 1,
	19: 2270 - 1,
	20: 3381 - 1,
	21: 5463 - 1,
	22: 7921 - 1,
	23: 11819 - 1,
	24: 18712 - 1,
	25: 27842 - 1,
	26: 42646 - 1,
	27: 64275 - 1,
	28: 97328 - 1,
	29: 150678 - 1,
	30: 223730 - 1,
	31: 343711 - 1,
	32: 525238 - 1,
	33: 784952 - 1,
	34: 1208065 - 1,
	35: 1824910 - 1,
	36: 2774273 - 1,
	37: 4230422 - 1,
	38: 6365293 - 1,
	39: 9763578 - 1,
	40: 14777945 - 1,
	41: 22365694 - 1,
	42: 34205743 - 1,
	43: 51643260 - 1,
	44: 78678894 - 1,
	45: 119550250 - 1,
	46: 181040219 - 1,
	47: 276213919 - 1,
	48: 417940971 - 1,
	49: 635526775 - 1,
	50: 967190364 - 1,
	51: 1464254721 - 1,
	52: 2230181584 - 1,
	53: 3383369064 - 1,
	54: 5136784035 - 1,
	55: 7815929513 - 1,
	56: 11846276236 - 1,
	57: 18021119171 - 1,
	58: 27366673929 - 1,
	59: 41525589303 - 1,
	60: 63172165494 - 1,
	61: 95834918754 - 1,
	62: 145631430697 - 1,
	63: 221285376505 - 1,
	64: 335810508406 - 1,
	65: 510578405753 - 1,
	66: 775057917791 - 1,
	67: 1177233081218 - 1,
	68: 1789105460648 - 1,
	69: 2715548351448 - 1,
	70: 4126944742410 - 1,
	71: 6267603928109 - 1,
	72: 9517722204783 - 1,
	73: 14463411318409 - 1,
	74: 21959000077642 - 1,
	75: 33361879939123 - 1,
}

var lookup3Stone = []int{
	0:  1 - 1,
	1:  1 - 1,
	2:  2 - 1,
	3:  4 - 1,
	4:  4 - 1,
	5:  5 - 1,
	6:  10 - 1,
	7:  16 - 1,
	8:  26 - 1,
	9:  35 - 1,
	10: 52 - 1,
	11: 79 - 1,
	12: 114 - 1,
	13: 202 - 1,
	14: 294 - 1,
	15: 401 - 1,
	16: 642 - 1,
	17: 987 - 1,
	18: 1556 - 1,
	19: 2281 - 1,
	20: 3347 - 1,
	21: 5360 - 1,
	22: 7914 - 1,
	23: 12116 - 1,
	24: 18714 - 1,
	25: 27569 - 1,
	26: 42628 - 1,
	27: 64379 - 1,
	28: 98160 - 1,
	29: 150493 - 1,
	30: 223231 - 1,
	31: 344595 - 1,
	32: 524150 - 1,
	33: 788590 - 1,
	34: 1210782 - 1,
	35: 1821382 - 1,
	36: 2779243 - 1,
	37: 4230598 - 1,
	38: 6382031 - 1,
	39: 9778305 - 1,
	40: 14761601 - 1,
	41: 22417792 - 1,
	42: 34225846 - 1,
	43: 51690137 - 1,
	44: 78827911 - 1,
	45: 119542610 - 1,
	46: 181315830 - 1,
	47: 276460158 - 1,
	48: 418258991 - 1,
	49: 636641443 - 1,
	50: 967436144 - 1,
	51: 1466002423 - 1,
	52: 2232993017 - 1,
	53: 3385449247 - 1,
	54: 5144151283 - 1,
	55: 7821403715 - 1,
	56: 11858275227 - 1,
	57: 18043579638 - 1,
	58: 27385205762 - 1,
	59: 41578776877 - 1,
	60: 63230023120 - 1,
	61: 95919165597 - 1,
	62: 145810654517 - 1,
	63: 221464625286 - 1,
	64: 336184217342 - 1,
	65: 511098463417 - 1,
	66: 775739293861 - 1,
	67: 1178609585462 - 1,
	68: 1790704917622 - 1,
	69: 2718330612121 - 1,
	70: 4131363673883 - 1,
	71: 6273232027849 - 1,
	72: 9528181900890 - 1,
	73: 14477384086838 - 1,
	74: 21980614313123 - 1,
	75: 33397574184836 - 1,
}

var lookup4Stone = []int{
	0:  1 - 1,
	1:  1 - 1,
	2:  2 - 1,
	3:  4 - 1,
	4:  4 - 1,
	5:  4 - 1,
	6:  8 - 1,
	7:  16 - 1,
	8:  27 - 1,
	9:  30 - 1,
	10: 47 - 1,
	11: 82 - 1,
	12: 115 - 1,
	13: 195 - 1,
	14: 269 - 1,
	15: 390 - 1,
	16: 637 - 1,
	17: 951 - 1,
	18: 1541 - 1,
	19: 2182 - 1,
	20: 3204 - 1,
	21: 5280 - 1,
	22: 7721 - 1,
	23: 11820 - 1,
	24: 17957 - 1,
	25: 26669 - 1,
	26: 41994 - 1,
	27: 62235 - 1,
	28: 95252 - 1,
	29: 146462 - 1,
	30: 216056 - 1,
	31: 336192 - 1,
	32: 508191 - 1,
	33: 766555 - 1,
	34: 1178119 - 1,
	35: 1761823 - 1,
	36: 2709433 - 1,
	37: 4110895 - 1,
	38: 6188994 - 1,
	39: 9515384 - 1,
	40: 14316637 - 1,
	41: 21807800 - 1,
	42: 33255984 - 1,
	43: 50149950 - 1,
	44: 76709712 - 1,
	45: 116004670 - 1,
	46: 176169842 - 1,
	47: 268815408 - 1,
	48: 405925411 - 1,
	49: 618986605 - 1,
	50: 939523808 - 1,
	51: 1424046245 - 1,
	52: 2170908709 - 1,
	53: 3286453556 - 1,
	54: 4999818380 - 1,
	55: 7599067248 - 1,
	56: 11516149089 - 1,
	57: 17538646495 - 1,
	58: 26595346202 - 1,
	59: 40399586486 - 1,
	60: 61439053769 - 1,
	61: 93157147262 - 1,
	62: 141707341785 - 1,
	63: 215121357662 - 1,
	64: 326594116560 - 1,
	65: 496648284472 - 1,
	66: 753474466137 - 1,
	67: 1145237350863 - 1,
	68: 1739662144358 - 1,
	69: 2640672818870 - 1,
	70: 4014395018228 - 1,
	71: 6093717587578 - 1,
	72: 9257463114209 - 1,
	73: 14065709226166 - 1,
	74: 21352521089525 - 1,
	75: 32450231489345 - 1,
}

var lookup5Stone = []int{
	0:  1 - 1,
	1:  1 - 1,
	2:  1 - 1,
	3:  2 - 1,
	4:  4 - 1,
	5:  8 - 1,
	6:  8 - 1,
	7:  11 - 1,
	8:  22 - 1,
	9:  32 - 1,
	10: 45 - 1,
	11: 67 - 1,
	12: 109 - 1,
	13: 163 - 1,
	14: 223 - 1,
	15: 383 - 1,
	16: 597 - 1,
	17: 808 - 1,
	18: 1260 - 1,
	19: 1976 - 1,
	20: 3053 - 1,
	21: 4529 - 1,
	22: 6675 - 1,
	23: 10627 - 1,
	24: 15847 - 1,
	25: 23822 - 1,
	26: 37090 - 1,
	27: 55161 - 1,
	28: 84208 - 1,
	29: 128121 - 1,
	30: 194545 - 1,
	31: 298191 - 1,
	32: 444839 - 1,
	33: 681805 - 1,
	34: 1042629 - 1,
	35: 1565585 - 1,
	36: 2396146 - 1,
	37: 3626619 - 1,
	38: 5509999 - 1,
	39: 8396834 - 1,
	40: 12678459 - 1,
	41: 19375816 - 1,
	42: 29353796 - 1,
	43: 44468482 - 1,
	44: 67897697 - 1,
	45: 102728207 - 1,
	46: 156270923 - 1,
	47: 237448520 - 1,
	48: 359945119 - 1,
	49: 548404180 - 1,
	50: 830902728 - 1,
	51: 1262810287 - 1,
	52: 1920773112 - 1,
	53: 2910904745 - 1,
	54: 4429562772 - 1,
	55: 6723617334 - 1,
	56: 10208238298 - 1,
	57: 15523686504 - 1,
	58: 23546156396 - 1,
	59: 35800677601 - 1,
	60: 54373596862 - 1,
	61: 82527381401 - 1,
	62: 125485168005 - 1,
	63: 190450830578 - 1,
	64: 289353664282 - 1,
	65: 439635296562 - 1,
	66: 667354407235 - 1,
	67: 1014322133136 - 1,
	68: 1540093078996 - 1,
	69: 2339196397813 - 1,
	70: 3554443567139 - 1,
	71: 5396279119470 - 1,
	72: 8199376885602 - 1,
	73: 12453343570608 - 1,
	74: 18912305922966 - 1,
	75: 28735448607417 - 1,
}

var lookup6Stone = []int{
	0:  1 - 1,
	1:  1 - 1,
	2:  1 - 1,
	3:  2 - 1,
	4:  4 - 1,
	5:  8 - 1,
	6:  8 - 1,
	7:  11 - 1,
	8:  22 - 1,
	9:  32 - 1,
	10: 54 - 1,
	11: 68 - 1,
	12: 103 - 1,
	13: 183 - 1,
	14: 250 - 1,
	15: 401 - 1,
	16: 600 - 1,
	17: 871 - 1,
	18: 1431 - 1,
	19: 2033 - 1,
	20: 3193 - 1,
	21: 4917 - 1,
	22: 7052 - 1,
	23: 11371 - 1,
	24: 16815 - 1,
	25: 25469 - 1,
	26: 39648 - 1,
	27: 57976 - 1,
	28: 90871 - 1,
	29: 136703 - 1,
	30: 205157 - 1,
	31: 319620 - 1,
	32: 473117 - 1,
	33: 727905 - 1,
	34: 1110359 - 1,
	35: 1661899 - 1,
	36: 2567855 - 1,
	37: 3849988 - 1,
	38: 5866379 - 1,
	39: 8978479 - 1,
	40: 13464170 - 1,
	41: 20675981 - 1,
	42: 31260715 - 1,
	43: 47355277 - 1,
	44: 72483044 - 1,
	45: 109181845 - 1,
	46: 166707433 - 1,
	47: 253134047 - 1,
	48: 382914632 - 1,
	49: 585166040 - 1,
	50: 884539345 - 1,
	51: 1345613788 - 1,
	52: 2047645435 - 1,
	53: 3098356892 - 1,
	54: 4724206377 - 1,
	55: 7160643536 - 1,
	56: 10872985370 - 1,
	57: 16552155417 - 1,
	58: 25070272242 - 1,
	59: 38158143567 - 1,
	60: 57933790448 - 1,
	61: 87899668107 - 1,
	62: 133766380622 - 1,
	63: 202834276931 - 1,
	64: 308334249199 - 1,
	65: 468500329699 - 1,
	66: 710790290058 - 1,
	67: 1081062428072 - 1,
	68: 1640664018003 - 1,
	69: 2492210120859 - 1,
	70: 3787836798694 - 1,
	71: 5748162028732 - 1,
	72: 8737608441604 - 1,
	73: 13268147991514 - 1,
	74: 20148203460634 - 1,
	75: 30621612661601 - 1,
}

var lookup7Stone = []int{
	0:  1 - 1,
	1:  1 - 1,
	2:  1 - 1,
	3:  2 - 1,
	4:  4 - 1,
	5:  8 - 1,
	6:  8 - 1,
	7:  11 - 1,
	8:  22 - 1,
	9:  32 - 1,
	10: 52 - 1,
	11: 72 - 1,
	12: 106 - 1,
	13: 168 - 1,
	14: 242 - 1,
	15: 413 - 1,
	16: 602 - 1,
	17: 832 - 1,
	18: 1369 - 1,
	19: 2065 - 1,
	20: 3165 - 1,
	21: 4762 - 1,
	22: 6994 - 1,
	23: 11170 - 1,
	24: 16509 - 1,
	25: 25071 - 1,
	26: 39034 - 1,
	27: 57254 - 1,
	28: 88672 - 1,
	29: 134638 - 1,
	30: 203252 - 1,
	31: 312940 - 1,
	32: 465395 - 1,
	33: 716437 - 1,
	34: 1092207 - 1,
	35: 1637097 - 1,
	36: 2519878 - 1,
	37: 3794783 - 1,
	38: 5771904 - 1,
	39: 8814021 - 1,
	40: 13273744 - 1,
	41: 20328089 - 1,
	42: 30742356 - 1,
	43: 46604985 - 1,
	44: 71251415 - 1,
	45: 107529561 - 1,
	46: 163892525 - 1,
	47: 248939400 - 1,
	48: 377032515 - 1,
	49: 575197697 - 1,
	50: 870467992 - 1,
	51: 1323890750 - 1,
	52: 2013655038 - 1,
	53: 3049406611 - 1,
	54: 4645433144 - 1,
	55: 7045685002 - 1,
	56: 10698321736 - 1,
	57: 16276414188 - 1,
	58: 24671676894 - 1,
	59: 37533047662 - 1,
	60: 56988774248 - 1,
	61: 86488411300 - 1,
	62: 131561415506 - 1,
	63: 199575001348 - 1,
	64: 303311548004 - 1,
	65: 460837978219 - 1,
	66: 699372964501 - 1,
	67: 1063331414844 - 1,
	68: 1614094135973 - 1,
	69: 2451830128654 - 1,
	70: 3725902804244 - 1,
	71: 5655408093234 - 1,
	72: 8595002059570 - 1,
	73: 13052617650290 - 1,
	74: 19822054252432 - 1,
	75: 30121450842288 - 1,
}

var lookup8Stone = []int{
	0:  1 - 1,
	1:  1 - 1,
	2:  1 - 1,
	3:  2 - 1,
	4:  4 - 1,
	5:  7 - 1,
	6:  7 - 1,
	7:  11 - 1,
	8:  22 - 1,
	9:  31 - 1,
	10: 48 - 1,
	11: 69 - 1,
	12: 103 - 1,
	13: 161 - 1,
	14: 239 - 1,
	15: 393 - 1,
	16: 578 - 1,
	17: 812 - 1,
	18: 1322 - 1,
	19: 2011 - 1,
	20: 3034 - 1,
	21: 4580 - 1,
	22: 6798 - 1,
	23: 10738 - 1,
	24: 16018 - 1,
	25: 24212 - 1,
	26: 37525 - 1,
	27: 55534 - 1,
	28: 85483 - 1,
	29: 130183 - 1,
	30: 196389 - 1,
	31: 301170 - 1,
	32: 450896 - 1,
	33: 691214 - 1,
	34: 1054217 - 1,
	35: 1583522 - 1,
	36: 2428413 - 1,
	37: 3669747 - 1,
	38: 5573490 - 1,
	39: 8505207 - 1,
	40: 12835708 - 1,
	41: 19605147 - 1,
	42: 29704486 - 1,
	43: 45028011 - 1,
	44: 68747690 - 1,
	45: 103934296 - 1,
	46: 158185825 - 1,
	47: 240410770 - 1,
	48: 364289594 - 1,
	49: 555105869 - 1,
	50: 841069902 - 1,
	51: 1278299521 - 1,
	52: 1944190437 - 1,
	53: 2946226464 - 1,
	54: 4484326329 - 1,
	55: 6805591722 - 1,
	56: 10332097590 - 1,
	57: 15714538160 - 1,
	58: 23833683818 - 1,
	59: 36238383740 - 1,
	60: 55037373871 - 1,
	61: 83534994701 - 1,
	62: 127024485591 - 1,
	63: 192770563390 - 1,
	64: 292891568245 - 1,
	65: 445020687753 - 1,
	66: 675489979403 - 1,
	67: 1026733290935 - 1,
	68: 1558911226168 - 1,
	69: 2367783267114 - 1,
	70: 3597921540463 - 1,
	71: 5462124639438 - 1,
	72: 8299712231826 - 1,
	73: 12605551395981 - 1,
	74: 19143219233647 - 1,
	75: 29087020205323 - 1,
}

var lookup9Stone = []int{
	0:  1 - 1,
	1:  1 - 1,
	2:  1 - 1,
	3:  2 - 1,
	4:  4 - 1,
	5:  8 - 1,
	6:  8 - 1,
	7:  11 - 1,
	8:  22 - 1,
	9:  32 - 1,
	10: 54 - 1,
	11: 70 - 1,
	12: 103 - 1,
	13: 183 - 1,
	14: 262 - 1,
	15: 419 - 1,
	16: 586 - 1,
	17: 854 - 1,
	18: 1468 - 1,
	19: 2131 - 1,
	20: 3216 - 1,
	21: 4888 - 1,
	22: 7217 - 1,
	23: 11617 - 1,
	24: 17059 - 1,
	25: 25793 - 1,
	26: 40124 - 1,
	27: 58820 - 1,
	28: 92114 - 1,
	29: 139174 - 1,
	30: 208558 - 1,
	31: 322818 - 1,
	32: 480178 - 1,
	33: 740365 - 1,
	34: 1126352 - 1,
	35: 1685448 - 1,
	36: 2602817 - 1,
	37: 3910494 - 1,
	38: 5953715 - 1,
	39: 9102530 - 1,
	40: 13675794 - 1,
	41: 20970437 - 1,
	42: 31705673 - 1,
	43: 48074246 - 1,
	44: 73537869 - 1,
	45: 110811935 - 1,
	46: 169092081 - 1,
	47: 256830213 - 1,
	48: 388727714 - 1,
	49: 593534295 - 1,
	50: 897592763 - 1,
	51: 1365513047 - 1,
	52: 2077309718 - 1,
	53: 3144423073 - 1,
	54: 4792957707 - 1,
	55: 7266163233 - 1,
	56: 11033309991 - 1,
	57: 16792025848 - 1,
	58: 25442648670 - 1,
	59: 38716940493 - 1,
	60: 58780298247 - 1,
	61: 89198234571 - 1,
	62: 135718181667 - 1,
	63: 205824986739 - 1,
	64: 312858253566 - 1,
	65: 475352922955 - 1,
	66: 721283109638 - 1,
	67: 1096862549472 - 1,
	68: 1664773930182 - 1,
	69: 2528876426307 - 1,
	70: 3843251145519 - 1,
	71: 5832794158307 - 1,
	72: 8865669337036 - 1,
	73: 13462884780433 - 1,
	74: 20444566374734 - 1,
	75: 31069966778992 - 1,
}
